# Взаимодействие между сервисами

Возможно вы задаетесь вопросом, как сервисы взаимодействуют друг с другом в _сервисно-ориентированной_ и _микросервисной_ архитектуре. Как такое может быть, что два независимых приложения, которые могут быть написаны на разных языках программирования, могут общаться друг с другом?

В этой главе мы кратко рассмотрим основные концепции взаимодействия между сервисами, оставив более детальное изучение на последующие разделы.

## Введение в API

Для взаимодействия между сервисами используется **API** (*Application Programming Interface*), который позволяет одному приложению общаться с другим. 

**API** определяет набор правил и стандартов, которые определяют, как одно приложение может взаимодействовать с другим [^1].

**API** играет ключевую роль в обеспечении совместимости и обмена данными между различными сервисами, независимо от их внутренней реализации и используемых технологий.

**Пример взаимодействия сервисов**:

Как вы думаете, каким образом сервисы могут общаться друг с другом? Один из простейших методов взаимодействия — это использование текстовых файлов. Рассмотрим пример:

1. Сервис `A` записывает данные пользователя в файл.
2. Сервис `B` читает данные пользователя из файла и записывает их в базу данных.

Это можно считать примитивным API, так как сервисы `A` и `B` обмениваются данными через файл. Однако такой способ имеет множество недостатков.

## Современные API

Существует множество способов взаимодействия между сервисами, которые позволяют обмениваться данными и управлять состоянием приложения. Рассмотрим некоторые из них:
1. **HTTP API (REST)**: Один из наиболее распространенных подходов, основанный на протоколе HTTP и принципах REST (Representational State Transfer). Сервисы обмениваются данными в формате JSON или XML через HTTP-запросы. Например, один сервис отправляет HTTP-запрос с данными, а другой сервис обрабатывает запрос и возвращает ответ [^2].
2. **Message Queues**: Использование очередей сообщений (например, RabbitMQ, Kafka) для асинхронного обмена данными между сервисами. Например, сервис `A` отправляет сообщение в очередь, а сервис `B` получает сообщение и обрабатывает его [^3].
3. **gRPC**: Современный протокол удаленного вызова процедур (RPC), который позволяет сервисам обмениваться данными и вызывать удаленные процедуры [^4].

## Почему API называют интерфейсом?

**Интерфейс** — это граница между двумя системами, которая позволяет им обмениваться данными и взаимодействовать друг с другом. Например, кнопка на кофемашине — это интерфейс, который позволяет вам выбрать тип кофе. Вы не знаете, как работает кофемашина внутри, но вы можете использовать интерфейс для взаимодействия с ней.

В свою очередь, **API** — это интерфейс, который позволяет программам обмениваться данными и вызывать функции друг друга. Например, сервис `A` может отправить запрос к сервису `B` через API, чтобы получить данные или выполнить операцию. 

Сервис `A` не знает, как работает сервис `B` внутри, но он может использовать "кнопки" (API) для взаимодействия с ним.

Например, такой кнопкой может служить HTTP-запрос. 

1. Сервис `A` отправляет HTTP-запрос к сервису `B` и "говорит": "Дай мне данные пользователя с ID=123".
2. Сервис `B` получает запрос, обрабатывает его и отправляет ответ с данными пользователя.

[^1]: What is API: Application programming interface? medium.com [online]. Available: https://medium.com/javarevisited/what-is-api-application-programming-interface-3e8985ac0fd4
[^2]: Что такое HTTP, API, REST API. evgenii-afanasev.gitbook.io [online]. Available: https://evgenii-afanasev.gitbook.io/ruby-course/11_network/1_http_api_rest
[^3]: Introduction to Message Queuing, medium.com [online]. Available: https://medium.com/tech-sauce/introduction-to-message-queuing-4a7ab8968b59
[^4]: gRPC — Why, What and How, medium.com [online]. Available: https://medium.com/geekculture/grpc-why-what-and-how-77080a59fc43