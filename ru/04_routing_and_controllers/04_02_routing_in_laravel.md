# Маршрутизация в Laravel

В общем, маршрутизация в Laravel работает аналогично другим фреймворкам: URL-адрес и HTTP-метод запроса сопоставляются с определённой функцией или методом в приложении.

## Директория маршрутов `routes`

Маршруты определяются в директории `routes`. В этой директории находятся различные файлы, каждый из которых предназначен для определённого типа маршрутов:

- `web.php` — для маршрутов, используемых в стандартных веб-приложениях.
- `api.php` — для маршрутов, предназначенных для API.
- `console.php` — для маршрутов, связанных с консольными командами.

На данный момент мы будем рассматривать только файл `web.php`, поскольку он применяется для работы с обычными веб-приложениями.

## Основы маршрутизации в Laravel [^1]

Простейший маршрут в Laravel принимает **URI** и **функцию**, которое выполняется при сопоставлении маршрута. **Например**:

```php
Route::get('/hello', function () {
    return 'Hello, World';
});
```

Когда пользователь отправляет запрос `GET` на URL-адрес `/hello`, в ответ он получает строку `Hello, World`.

> [!NOTE]
> Маршруты автоматически загружаются во время загрузки приложения, поэтому вам не нужно явно загружать их.

### Доступные методы маршрутизации

Маршрутизатор Laravel предоставляет несколько методов, которые соответствуют каждому HTTP-методу:

```php
Route::get($uri, $callback); // Маршрут для GET-запроса
Route::post($uri, $callback); // Маршрут для POST-запроса
Route::put($uri, $callback); // Маршрут для PUT-запроса
Route::patch($uri, $callback); // Маршрут для PATCH-запроса
Route::delete($uri, $callback); // Маршрут для DELETE-запроса
Route::options($uri, $callback); // Маршрут для OPTIONS-запроса
```

Например, если нужно создать маршрут, который будет обрабатывать `POST`-запрос, вы можете воспользоваться методом `post`:

```php
Route::post('/hello', function () {
    return 'Hello, World was created ;)';
});
```

Если необходимо зарегистрировать маршрут, который будет обрабатывать несколько HTTP-методов, можно использовать метод `match`:

```php
// Данный маршрут будет обработывать GET и POST запросы на URL-адрес /hello
Route::match(['get', 'post'], '/hello', function () {
    return 'Hello, World';
});
```

Или воспользоваться методом `any`, чтобы зарегистрировать маршрут, отвечающий на любой HTTP-запрос:

```php
// Данный маршрут будет обрабатывать любой HTTP-метод на URL-адрес /hello
Route::any('/hello', function () {
    return 'Hello, World';
});
```

> [!IMPORTANT]
> Несмотря на такую гибкость, рекомендуется явно указывать HTTP-метод с помощью методов `get`, `post`, `put`, `patch`, `delete` и `options` для более предсказуемого поведения маршрутов.


### Маршруты для перенаправления

Для перенаправления запросов с одного URL-адреса на другой можно использовать следующие методы:

- `redirect` — для **временного** перенаправления (*HTTP-код 302*)
- `permanentRedirect` — для **постоянного** перенаправления (*HTTP-код 301*)

```php
// Если пользователь отправит запрос на URL-адрес /user, он будет перенаправлен на /profile
Route::redirect('/user', '/profile');
// или
Route::permanentRedirect('/user', '/profile');
```

### Получение запроса

Часто возникает необходимость получить доступ к объекту запроса внутри обработчика маршрута.

> [!NOTE]
> **Объект запроса** — это экземпляр класса `Illuminate\Http\Request`, который содержит всю информацию о текущем HTTP-запросе, включая данные формы, заголовки, параметры запроса и т. д.

Чтобы использовать объект запроса в обработчике маршрута, его необходимо передать в качестве аргумента:

```php
use Illuminate\Http\Request;

// ...

// Получение объекта запроса и вывод заголовка User-Agent
Route::get('/hello', function (Request $request) {
    return $request->header('User-Agent'); // Получение заголовка User-Agent
});
```

> [!NOTE]
> В дальнейшем мы более подробно рассмотрим работу с объектом запроса.

### Список маршрутов

Для просмотра всех зарегистрированных маршрутов в приложении можно использовать команду `route:list`:

```bash
php artisan route:list
```

Часто в списке маршрутов присутствуют не только ваши собственные маршруты, но и маршруты, определённые фреймворком или сторонними пакетами. Чтобы отобразить только ваши маршруты, можно использовать флаг `--except-vendor`:

```bash
php artisan route:list --except-vendor
```

[^1]: Laravel Routing, laravel.com [online]. URL: https://laravel.com/docs/10.x/routing