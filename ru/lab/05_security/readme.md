# Лабораторная работа №5. Компоненты безопасности в Laravel

## Цель работы

Познакомиться с основами компонентов безопасности в Laravel, таких как **аутентификация**, **авторизация**, **защита от CSRF**, а также использование встроенных механизмов для управления доступом.

Освоить подходы к безопасной разработке, включая создание защищенных маршрутов и управление ролями пользователей.

## Условие

В данной лабораторной работе вы реализуете основные компоненты безопасности, такие как аутентификация, авторизация, защита маршрутов и базовая работа с ролями. Дополнительно вы настроите механизм сброса пароля и исследуете логирование действий пользователя.

> [!NOTE]
> Вы можете продолжать свою прошлую работу или начать новый проект.

### №1. Подготовка к работе

1. Создайте новый проект Laravel (если не установлен) или продолжите работу с прошлым проектом.
2. Убедитесь, что переменные окружения в `.env` настроены правильно, включая подключение к базе данных.

### №2. Аутентификация пользователей

1. Создайте контроллер `AuthController` для управления аутентификацией пользователей.
2. Добавьте и реализуйте методы для регистрации, входа и выхода пользователя.
   - `register()` для отображения формы регистрации.
   - `storeRegister()` для обработки данных формы регистрации.
   - `login()` для отображения формы входа.
   - `storeLogin()` для обработки данных формы входа.
3. Создайте маршруты для регистрации, входа и выхода пользователя.
4. Обновите представления для форм регистрации и входа.
5. Создайте отдельный класс `Request` для валидации данных при регистрации или входе, либо добавьте валидацию непосредственно в контроллер.
6. Проверьте, что регистрация и вход пользователя работают корректно.

### №3. Аутентификация пользователей с помощью готовых компонентов

> [!NOTE]
> Данный шаг является дополнительным и может быть выполнен после основной части работы.

1. Установите библиотеку **Laravel Breeze** (или Fortify, Jetstream) для быстрой настройки аутентификации.
    ```bash
    php artisan breeze:install
    npm install && npm run dev
    php artisan migrate
    ```
2. Следуйте инструкциям по установке и настройке пакета.
3. Проверьте, что маршруты `/register`, `/login`, `/logout` работают корректно.

### №4. Авторизация пользователей

1. Реализуйте страницу "Личный кабинет", доступ к которой имеют только авторизованные пользователи.
2. Настройте проверку доступа к данной странице, добавив middleware `auth` в маршрут или реализовав проверку в контроллере.
3. Обновите представление страницы "Личный кабинет", чтобы отображать информацию, доступную исключительно авторизованным пользователям.

### №5. Роли пользователей

1. Добавьте систему ролей: **Администратор** и **Пользователь**.
2. Настройте поведение для каждой роли:
   1. **Администратор**: имеет возможность просматривать личные кабинеты всех пользователей.
   2. **Пользователь**: может просматривать исключительно свой личный кабинет.
3. Реализуйте проверки ролей с использованием метода `can`, `Gate`, или `middleware`, чтобы обеспечить корректное распределение прав доступа.

### №6. Выход и защита от CSRF

1. Добавьте кнопку выхода пользователя на страницу.
2. Обеспечьте защиту от CSRF-атак на формах.
3. Проверьте, что выход пользователя работает корректно и безопасно.

## Контрольные вопросы

1. Какие готовые решения для аутентификации предоставляет Laravel?
2. Какие методы аутентификации пользователей вы знаете?
3. Чем отличается аутентификация от авторизации?
4. Как обеспечить защиту от CSRF-атак в Laravel?